<!-- Menu de Navega√ß√£o Tempor√°rio -->
<nav style="position: fixed; top: 0; left: 0; right: 0; background: #2d3748; color: white; padding: 1rem; z-index: 10000; display: flex; gap: 1rem; align-items: center;">
  <a href="/admin" style="color: white; text-decoration: none; padding: 0.5rem 1rem; background: #4a5568; border-radius: 4px;">Admin</a>
  <a href="/display" style="color: white; text-decoration: none; padding: 0.5rem 1rem; background: #38a169; border-radius: 4px;">Display</a>
  <a href="/visor" style="color: white; text-decoration: none; padding: 0.5rem 1rem; background: #4a5568; border-radius: 4px;">Visor</a>
  <span style="margin-left: auto; font-size: 0.9rem; opacity: 0.8;">üç¶ Painel de Gelateria</span>
</nav>

<div class="display" style="margin-top: 4rem;">
  <div class="controls">
    <label>Colunas <input type="number" [(ngModel)]="columns" min="1" max="8" /></label>
    <label>Linhas <input type="number" [(ngModel)]="rows" min="1" max="8" /></label>
    <button (click)="clearGrid()">Limpar Grid</button>
  </div>

  <div class="board">
    <!-- Grid de T√≠tulos -->
    <div class="header-section">
      <h3>T√≠tulos das Categorias</h3>
      <div class="header-grid" [style.gridTemplateColumns]="'repeat(' + columns + ', 1fr)'">
        @for (titleId of headerGrid().cells; track $index; let i = $index) {
          <div class="header-cell" cdkDropList [cdkDropListData]="i" [cdkDropListConnectedTo]="headerConnectedIds()" (cdkDropListDropped)="dropHeaderToCell($event, i)" [id]="'header-cell-' + i">
            @if (titleId) {
              <div class="header-chip" cdkDrag [cdkDragData]="titleId">
                {{ titleName(titleId) }}
              </div>
            }
            <button class="clear" (click)="clearHeaderCell(i)">√ó</button>
          </div>
        }
      </div>
    </div>

    <!-- Grid Principal de Sabores -->
    <div class="main-section">
      <h3>Sabores no Grid</h3>
      <div class="grid" [style.gridTemplateColumns]="'repeat(' + columns + ', 1fr)'" [style.gridTemplateRows]="'repeat(' + rows + ', 1fr)'">
        @for (id of grid().cells; track $index; let i = $index) {
          <div class="cell" cdkDropList [cdkDropListData]="i" [cdkDropListConnectedTo]="connectedIds()" (cdkDropListDropped)="dropToCell($event, i)" [id]="'cell-' + i">
            <div class="slot">
              @if (id) {
                <div class="flavor" cdkDrag [cdkDragData]="id">
                  @if (imageUrl(id)) {
                    <img [src]="imageUrl(id)" [alt]="imageName(id)" style="max-width: 100%; max-height: 100%; object-fit: cover;" />
                  } @else {
                    <span>{{ nameFor(id) }}</span>
                  }
                </div>
              }
              <button class="clear" (click)="clearCell(i)">√ó</button>
            </div>
          </div>
        }
      </div>
    </div>
  </div>

  <!-- Images palette -->
  <div class="palette" cdkDropList [cdkDropListConnectedTo]="cellIds()" [id]="'image-palette'">
    <h3>Sabores dispon√≠veis</h3>
    @for (group of availableImagesByCategory(); track group.category.id) {
      <div class="cat-group">
        <h4 class="cat-title">{{ group.category.name }}</h4>
        <div class="chips">
          @for (i of group.images; track i.id) {
            <div class="chip" cdkDrag [cdkDragData]="i.id">
              <img [src]="i.url" [alt]="i.name" style="max-width: 40px; max-height: 40px; object-fit: cover; margin-right: 0.5rem;" />
              {{ i.name }}
            </div>
          }
        </div>
      </div>
    }
    <p class="hint">Arraste um sabor para uma c√©lula. Clique no √ó para limpar.</p>
  </div>

  <!-- T√≠tulos palette -->
  <div class="palette" cdkDropList [cdkDropListConnectedTo]="headerCellIds()" [id]="'title-palette'">
    <h3>T√≠tulos dispon√≠veis</h3>
    <div class="chips">
      @for (t of availableTitles(); track t.id) {
        <div class="chip" cdkDrag [cdkDragData]="t.id">
          {{ t.name }}
        </div>
      }
    </div>
    <p class="hint">Arraste um t√≠tulo para uma c√©lula. Clique no √ó para limpar.</p>
  </div>
</div>


