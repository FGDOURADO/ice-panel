<!-- Menu de Navegação -->
<nav style="position: fixed; top: 0; left: 0; right: 0; background: #2d3748; color: white; padding: 1rem; z-index: 10000; display: flex; gap: 1rem; align-items: center;">
  <a routerLink="/" style="color: white; text-decoration: none; padding: 0.5rem 1rem; background: #667eea; border-radius: 4px;">🏠 Home</a>
  <a routerLink="/admin" style="color: white; text-decoration: none; padding: 0.5rem 1rem; background: #38a169; border-radius: 4px;">⚙️ Admin</a>
  <a routerLink="/display" style="color: white; text-decoration: none; padding: 0.5rem 1rem; background: #4a5568; border-radius: 4px;">🎯 Display</a>
  <a routerLink="/visor" style="color: white; text-decoration: none; padding: 0.5rem 1rem; background: #4a5568; border-radius: 4px;">📺 Visor</a>
  <span style="margin-left: auto; font-size: 0.9rem; opacity: 0.8;">🍦 Painel de Gelateria</span>
</nav>

<div class="admin" style="margin-top: 4rem;">
  <h1>🍦 Painel Administrativo</h1>

  <!-- Configurações de Exibição -->
  <section class="section">
    <h2>⚙️ Configurações de Exibição</h2>
    
    <div class="form-group">
      <label>URL da Logo</label>
      <input [(ngModel)]="logoUrl" placeholder="https://exemplo.com/logo.png" />
      <div style="margin-top: 0.75rem;">
        <button class="btn btn-primary" (click)="updateLogoUrl()">💾 Salvar Logo</button>
      </div>
    </div>

    <div class="color-picker-container">
      <label>🎨 Cor dos Títulos</label>
      <input type="color" [(ngModel)]="titleColor" />
      <button class="btn btn-primary" (click)="updateTitleColor()">💾 Salvar Cor</button>
    </div>

    <div class="checkbox-container">
      <input type="checkbox" [(ngModel)]="showGridLines" (change)="updateShowGridLines()" id="showGridLines" />
      <label for="showGridLines">📐 Exibir linhas do grid no visor</label>
    </div>
  </section>

  <section class="section">
    <h2>📂 Categorias</h2>
    <div class="form-group">
      <label>Nova Categoria</label>
      <input [(ngModel)]="newCategoryName" placeholder="Digite o nome da categoria" />
      <div style="margin-top: 0.75rem;">
        <button class="btn btn-success" (click)="addCategory()">➕ Adicionar Categoria</button>
      </div>
    </div>

    <div class="list">
      <div class="list-item" *ngFor="let c of categories()">
        <!-- Modo visualização -->
        <span *ngIf="editingCategory() !== c.id">{{ c.name }}</span>
        <!-- Modo edição -->
        <div *ngIf="editingCategory() === c.id" class="edit-form">
          <input [(ngModel)]="editCategoryName" placeholder="Nome da categoria" class="edit-input" />
        </div>
        <div class="actions">
          <!-- Botões modo visualização -->
          <button *ngIf="editingCategory() !== c.id" class="btn-edit" (click)="startEditCategory(c)">✏️ Editar</button>
          <button *ngIf="editingCategory() !== c.id" class="btn-delete" (click)="removeCategory(c)">🗑️ Excluir</button>
          <!-- Botões modo edição -->
          <button *ngIf="editingCategory() === c.id" class="btn-success" (click)="saveCategoryEdit(c.id)">💾 Salvar</button>
          <button *ngIf="editingCategory() === c.id" class="btn-danger" (click)="cancelCategoryEdit()">❌ Cancelar</button>
        </div>
      </div>
      <div class="empty-state" *ngIf="categories().length === 0">
        Nenhuma categoria cadastrada
      </div>
    </div>
  </section>


  <section class="section">
    <h2>🏷️ Títulos</h2>
    <div class="form-group">
      <label>Novo Título</label>
      <input [(ngModel)]="newTitleName" placeholder="Digite o nome do título" />
      <div style="margin-top: 0.75rem;">
        <button class="btn btn-success" (click)="addTitle()">➕ Adicionar Título</button>
      </div>
    </div>

    <div class="list">
      <div class="list-item" *ngFor="let t of titles()">
        <!-- Modo visualização -->
        <span *ngIf="editingTitle() !== t.id">{{ t.name }}</span>
        <!-- Modo edição -->
        <div *ngIf="editingTitle() === t.id" class="edit-form">
          <input [(ngModel)]="editTitleName" placeholder="Nome do título" class="edit-input" />
        </div>
        <div class="actions">
          <!-- Botões modo visualização -->
          <button *ngIf="editingTitle() !== t.id" class="btn-edit" (click)="startEditTitle(t)">✏️ Editar</button>
          <button *ngIf="editingTitle() !== t.id" class="btn-delete" (click)="removeTitle(t)">🗑️ Excluir</button>
          <!-- Botões modo edição -->
          <button *ngIf="editingTitle() === t.id" class="btn-success" (click)="saveTitleEdit(t.id)">💾 Salvar</button>
          <button *ngIf="editingTitle() === t.id" class="btn-danger" (click)="cancelTitleEdit()">❌ Cancelar</button>
        </div>
      </div>
      <div class="empty-state" *ngIf="titles().length === 0">
        Nenhum título cadastrado
      </div>
    </div>
  </section>

  <section class="section">
    <h2>🖼️ Imagens</h2>
    <div class="form-group">
      <label>Nome da Imagem</label>
      <input [(ngModel)]="newImageName" placeholder="Digite o nome da imagem" />
    </div>
    <div class="form-group">
      <label>URL da Imagem</label>
      <input [(ngModel)]="newImageUrl" placeholder="https://exemplo.com/imagem.jpg" />
    </div>
    <div class="form-group">
      <label>Categoria</label>
      <select [(ngModel)]="newImageCategoryId">
        <option value="">Selecione uma categoria</option>
        <option *ngFor="let c of categories()" [ngValue]="c.id">{{ c.name }}</option>
      </select>
    </div>
    <button class="btn btn-success" (click)="addImage()">➕ Adicionar Imagem</button>

    <!-- Campo de busca de imagens -->
    <div class="search-container" style="margin: 1.5rem 0;">
      <input 
        type="text" 
        [value]="searchImagesTerm()" 
        (input)="updateImagesSearchTerm($any($event.target).value)"
        placeholder="🔍 Buscar imagens..." 
        class="search-input"
        style="width: 100%; padding: 0.5rem; border: 1px solid #e2e8f0; border-radius: 4px; font-size: 0.9rem;"
      />
    </div>

    <div class="images-grid" *ngFor="let group of imagesByCategory()">
      <h3 class="cat-title">{{ group.category.name }}</h3>
      <div class="image-item" *ngFor="let i of group.images">
        <img [src]="i.url" [alt]="i.name" />
        <!-- Modo visualização -->
        <div *ngIf="editingImage() !== i.id">
          <div class="image-name">{{ i.name }}</div>
          <div class="image-category">{{ group.category.name }}</div>
        </div>
        <!-- Modo edição -->
        <div *ngIf="editingImage() === i.id" class="edit-form">
          <input [(ngModel)]="editImageName" placeholder="Nome da imagem" class="edit-input" />
          <input [(ngModel)]="editImageUrl" placeholder="URL da imagem" class="edit-input" />
          <select [(ngModel)]="editImageCategory" class="edit-select">
            <option *ngFor="let c of categories()" [ngValue]="c.id">{{ c.name }}</option>
          </select>
        </div>
        <div class="actions">
          <!-- Botões modo visualização -->
          <button *ngIf="editingImage() !== i.id" class="btn-edit" (click)="startEditImage(i)">✏️ Editar</button>
          <button *ngIf="editingImage() !== i.id" class="btn-delete" (click)="removeImage(i)">🗑️ Excluir</button>
          <!-- Botões modo edição -->
          <button *ngIf="editingImage() === i.id" class="btn-success" (click)="saveImageEdit(i.id)">💾 Salvar</button>
          <button *ngIf="editingImage() === i.id" class="btn-danger" (click)="cancelImageEdit()">❌ Cancelar</button>
        </div>
      </div>
    </div>
    
    <!-- Mensagem quando não há resultados de busca -->
    <div *ngIf="imagesByCategory().length === 0 && searchImagesTerm().trim()" class="no-results" style="text-align: center; padding: 1rem; color: #718096; font-style: italic;">
      🔍 Nenhuma imagem encontrada para "{{ searchImagesTerm() }}"
    </div>
    
    <div class="empty-state" *ngIf="images().length === 0">
      Nenhuma imagem cadastrada
    </div>
  </section>
</div>


